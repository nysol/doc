
%\begin{document}

\section{項目の指定\label{sect:fieldname}}
MCMDでは、CSVデータの先頭行を項目名として扱うことも可能であるし、
また項目名行がなくても項目番号で項目を指定することもできる。
項目名行の扱いに関係するパラメータは-nfn,-nfno,-nfni,-xの４つある。
以下では、例を示しながら、その利用方法について説明する。
なお、項目番号は左から0,1,2のように0から始まることに注意する。

\input{examples/tex/field_name1_ex.tex}

\subsection{有効な項目名}

項目名として利用可能な文字は以下の通りである。
\begin{itemize}
\item アルファベット(a-z,A-Z)
\item 数字(0-9)
\item マルチバイト文字(UTF-8など)
\item 記号
\end{itemize}

ただし、記号については、以下の9つの利用は避けることを推奨する。
利用してエラーとなるわけではないが、いずれもMCMDの中で項目指定時の特殊文字として利用しており
その特殊用途を利用できなくなる可能性があるからである。

\begin{itemize}
\item \verb|,| カンマ
\item \verb|:| コロン
\item \verb|%| パーセント
\item \verb|*| アスタリスク
\item \verb|?| クエスチョンマーク
\item \verb|&| アンド
\item \verb|\| バックスラッシュ
\item \verb|]| 四角括弧右
\item \verb|[| 四角括弧左
\end{itemize}

\subsection{有効な項目番号}

項目番号の指定では、単純に項目番号をカンマで区切って列挙する以外にも、
後ろの項目からの番号指定(\verb|"L"|を付ける)や範囲(\verb|-|)を指定することが可能である。
例えば\verb|0L|とすれば、最後の項目を指定したことになり、
\verb|2L|とすれば、最後から数えて2番目の項目(0番から始まることに注意)を指定したことになる。
また\verb|0-5|と指定すれば、0番項目から5番項目まで6つの項目を指定したことになる。
すなわち\verb|0,1,2,3,4,5|と指定したことと同等である。

\input{examples/tex/field_number_ex.tex}

\subsection{入力項目と出力項目}

多くのコマンドで項目の指定には\verb|f=|が利用される。
\verb|f=|の書式は、「入力項目:出力項目」で、
出力項目名の指定を省略すれば、入力項目名が出力項目名として利用される。
また、\verb|-x|を指定することで\verb|f=0:数量|のように、番号指定と混在させることも可能である。

\input{examples/tex/field_io_ex.tex}

\subsection{ワイルドカード}
複数項目を指定する際にはには、項目名に\verb|"*"|と\verb|"?"|のワイルドカードを利用することができる。
\verb|"*"|は任意の長さの任意の文字列にマッチし、\verb|"?"|は任意の1文字にマッチする。
また、ワイルドカードの評価順は入力データ上の項目の並び順となることに注意する。
例えば、入力データの項目の並びが、\verb|A5,A3,A4,A2,A1|であれば、\verb|f=A*|は
\verb|f=A5,A3,A4,A2,A1|と評価される。

\input{examples/tex/field_wc_ex.tex}

\subsection{出力項目名の置換}

出力項目名で指定された\verb|"&"|は特殊な意味を持ち、入力項目名に置換される。
例えば、\verb|f=abc:xx&xx|では、出力項目名は\verb|xxabcxx|に置換される。
\verb|"&"|は、出力項目名の任意の位置に指定することができ、またその指定数に制限はない。
ただし、\verb|"&"|記号は、シェルにおいて「バックグラウンド実行」と解釈されてしまうので、
ダブルクォーツで囲うなどしてエスケープする必要がある。

\input{examples/tex/field_rep_ex.tex}

\subsection{集計処理コマンドについての注意点}
集計処理コマンドでは、キー項目ごとに指定された項目が集計処理され、キー項目ごとに１行出力される際、指定した項目以外の項目はどのレコードが出力さるかについては不定である。
例えば、msumコマンドで、顧客、日付、商品、金額という項目のデータを想定し、
msumコマンドで顧客別に金額を集計するのに、\verb|msum k=顧客 f=金額|と指定した場合、
それ以外の日付、商品項目についてはどのレコードが出力されるか不定であることに注意する。

%\end{document}

