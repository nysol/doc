
%\documentclass[a4paper]{jsbook}
%\usepackage{mcmd_jp}
%\begin{document}

\section{mshuffle レコード分割\label{sect:mshuffle}}
\index{mshuffle@mshuffle}
\verb|f=|で指定した項目のhash値に従って指定した数のファイルに入力ファイルを分割する。
分割数(hashサイズ)を$n$とすると、f=で指定した「項目の値」$v$のhash値は
$n$の剰余($v$\ mod\ $n$)として計算される。
「項目の値」は、データを文字列として考え、バイト単位の文字コードの合計値として計算される。
\verb|f=|を指定しなかった場合は、「項目の値」として行番号が用いられる。
そして、各行は、得られたhash値を名前に持ったファイルに出力される。
以上の方法により、同じ項目データを持つ行は全て同一のファイルに出力されることが保証される。

また、\verb|v=|で重みを指定することで、分割される各ファイルに複数のhash値を割り当てることもできる。
\verb|n=3,v=2,1,3|と指定すれば、hashサイズを重みの合計$2+1+3=6$とし、
2つのhash値(0,1)を分割ファイル0に、1つのhash値(2)を分割ファイル1に、
そして3つのhash値(3,4,5)を分割ファイル2に出力する。
重みはhash値の割当数の重みであり、出力行数の重みではないことに注意する。

\subsection*{書式}
\verb/mshuffle n=|v= d= [f=]/
\hyperref[sect:option_i]{[i=]}
\hyperref[sect:option_nfn]{[-nfn]} 
\hyperref[sect:option_nfno]{[-nfno]}  
\hyperref[sect:option_x]{[-x]}
\hyperref[sect:option_tmpPath]{[tmpPath=]} 
\hyperref[sect:option_precision]{[precision=]}
\verb|[-params]|
\verb|[--help]|
\verb|[--helpl]|
\verb|[--version]|\\

\subsection*{パラメータ}
\begin{table}[htbp]
%\begin{center}
{\small
\begin{tabular}{ll}
\verb|i=|      & 入力ファイル名を指定する。\\
\verb|d=|      & 出力するファイル名の接頭辞を指定する\\
               & ここで指定した値＋連番(hash値)が実際に出力されるファイル名になる\\
\verb|f=|      & 分割単位となるキーを指定する\\
               & ここで指定した項目値が等しいものは同じファイルに出力される\\
\verb|n=|      & 分割するファイル数を指定する\\
\verb|v=|      & 分割するファイルごとにデータ量の重みを指定する\\
\end{tabular} 
}
\end{table} 

%\subsection*{備考}
%\begin{itemize}
%\item 重みを指定しなかった場合すべて同じ重みとなる。f=に指定した項目値によっては指定した重み通りの結果にならない場合がある
%\end{itemize}

\subsection*{利用例}
\input{examples/tex/mshuffle_ex.tex}

\subsection*{関連コマンド}
\hyperref[sect:msep]{msep} : 項目値によるレコードの分割

%\end{document}

